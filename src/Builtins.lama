-- Builtins
import World;

public fun evalBuiltinRead (c@[st, w]) {
  case readWorld (w) of
    [value, w] -> [[st, w], value]
 esac
}

public fun evalBuiltinWrite (c@[st, w], value) {
  [[st, writeWorld (value, w)], Void]
}

public fun evalBuiltinLength (c, value) {
  case value of
    Sexp (_, contents) -> [c, contents.length]
  | _ -> [c, value.length]
 esac
}
